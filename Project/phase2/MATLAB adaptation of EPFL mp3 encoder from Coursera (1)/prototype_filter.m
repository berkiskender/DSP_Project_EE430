 function h = prototype_filter()
 h=firpm(511,[0 1/128 1/32 1],[2 2 0 0]);
%  h = [8.78199583296425e-06,3.67717287779931e-06,4.42052824325994e-06,5.25290448510222e-06,6.15996450777538e-06,7.16117012783087e-06,8.24536112526484e-06,9.43097703994361e-06,1.06968763259065e-05,1.20580403789816e-05,1.35010055623710e-05,1.50545257512436e-05,1.66681637559877e-05,1.83751138282107e-05,2.01577025219395e-05,2.20055061843758e-05,2.39162208818158e-05,2.58805227080649e-05,2.78876020120787e-05,2.99282822271327e-05,3.19835801068571e-05,3.40467332801051e-05,3.60970578309992e-05,3.81189531156271e-05,4.00888019056904e-05,4.19985999292209e-05,4.38102652410623e-05,4.55174305776635e-05,4.70822383519769e-05,4.84922887066542e-05,4.97097791127208e-05,5.07171292012439e-05,5.14773398224135e-05,5.19714048029325e-05,5.21583781557696e-05,5.20185027363957e-05,5.15143625910949e-05,5.06213844697573e-05,4.93032309606633e-05,4.75385667982273e-05,4.52892632743473e-05,4.25373825294687e-05,3.92448899661170e-05,3.53977921139228e-05,3.09613806485637e-05,2.59234560218364e-05,2.02541172100938e-05,1.39477595623463e-05,6.97789377621773e-06,-6.55137268709101e-07,-8.96900969145085e-06,-1.79581646955893e-05,-2.76312155424877e-05,-3.79751611176573e-05,-4.89891400411735e-05,-6.06501508549682e-05,-7.29489751881720e-05,-8.58514555859111e-05,-9.93367663080746e-05,-0.000113360569271834,-0.000127890706927779,-0.000142869437775721,-0.000158253707821362,-0.000173972892208912,-0.000189971677513269,-0.000206167045962058,-0.000222490447283802,-0.000238847992818863,-0.000255158264092647,-0.000271315249330752,-0.000287226800827898,-0.000302776201033587,-0.000317859953522892,-0.000332352411571494,-0.000346140969626917,-0.000359091759517786,-0.000371085298008465,-0.000381980925682637,-0.000391655231399366,-0.000399963355156309,-0.000406779085247442,-0.000411957318985585,-0.000415372286401209,-0.000416880555820502,-0.000416360434641095,-0.000413674200291730,-0.000408707088801112,-0.000401330962065220,-0.000391441476615873,-0.000378924280729169,-0.000363689630096665,-0.000345639704571766,-0.000324704261897088,-0.000300806194079904,-0.000273897729664828,-0.000243926709451713,-0.000210872091732796,-0.000174709931877667,-0.000135449614881011,-9.30988639122918e-05,-4.77009760520022e-05,7.01209498865955e-07,5.20284902274254e-05,0.000106199517192029,0.000163096539342000,0.000222598455822985,0.000284546838935617,0.000348779157285519,0.000415095606253104,0.000483291607030441,0.000553125705451772,0.000624351422881045,0.000696686075526060,0.000769843078126542,0.000843499627284746,0.000917330818122963,0.000990977105679098,0.00106407799157221,0.00113624063858213,0.00120707336811951,0.00127615475255506,0.00134306707193251,0.00140736596787449,0.00146861375734487,0.00152635031827525,0.00158012488549913,0.00162946889656490,0.00167392729232437,0.00171303123561956,0.00174633010991377,0.00177336432508298,0.00179369727744292,0.00180688848306216,0.00181252541651140,0.00181019699654417,0.00179952559557787,0.00178013999257927,0.00175170787202405,0.00171390922182404,0.00166646749892866,0.00160912438248250,0.00154166991812049,0.00146391776020844,0.00137573466202004,0.00127701598641330,0.00116771464602476,0.00104781695802478,0.000917370439956340,0.000776460152074664,0.000625236158780627,0.000463888913714435,0.000292676962850102,0.000111901881794253,-7.80647817119758e-05,-0.000276806503411686,-0.000483835885930399,-0.000698619447922474,-0.000920552748788416,-0.00114898541636875,-0.00138319713385577,-0.00162242231415800,-0.00186582796348525,-0.00211253770482508,-0.00236161082497061,-0.00261206665465724,-0.00286286423757499,-0.00311292722719260,-0.00336112413103945,-0.00360629354869915,-0.00384722541909614,-0.00408268629316821,-0.00431140119875253,-0.00453207957558094,-0.00474339761419135,-0.00494402407977145,-0.00513260399177078,-0.00530778383957331,-0.00546819653312283,-0.00561248609831709,-0.00573929354521750,-0.00584728143572537,-0.00593512027748656,-0.00600151266178136,-0.00604518058646921,-0.00606488903077331,-0.00605943348909241,-0.00602766363186324,-0.00596847069537563,-0.00588081093694837,-0.00576369311132471,-0.00561620125352288,-0.00543748259217205,-0.00522676927401569,-0.00498336645644592,-0.00470667327532655,-0.00439617097118067,-0.00405144251724865,-0.00367216124268514,-0.00325810894630045,-0.00280916458437056,-0.00232532123924779,-0.00180667440382880,-0.00125343810195681,-0.000665932518248199,-4.45990190761001e-05,0.000610012523302845,0.00129722998673055,0.00201627233220745,0.00276623681619407,0.00354611294703713,0.00435477111795479,0.00519097671571493,0.00605338050499037,0.00694053268898701,0.00785087504202962,0.00878275519280410,0.00973442003583665,0.0107040304050486,0.0116896559083549,0.0126892896935510,0.0137008445561543,0.0147221681459778,0.0157510398777878,0.0167851866714834,0.0178222806003041,0.0188599548978800,0.0198958026092556,0.0209273923376460,0.0219522679840860,0.0229679642824752,0.0239720072782847,0.0249619294851316,0.0259352713105434,0.0268895954129827,0.0278224889836774,0.0287315773577529,0.0296145267351920,0.0304690572737960,0.0312929457853485,0.0320840382979445,0.0328402527906814,0.0335595908405206,0.0342401402952876,0.0348800861247068,0.0354777127180601,0.0360314137516000,0.0365396943128375,0.0370011793264473,0.0374146157191948,0.0377788791119938,0.0380929759401240,0.0383560485911646,0.0385673770987483,0.0387263827688408,0.0388326295447664,0.0388858259498520,0.0388858259498520,0.0388326295447664,0.0387263827688408,0.0385673770987483,0.0383560485911646,0.0380929759401240,0.0377788791119938,0.0374146157191948,0.0370011793264473,0.0365396943128375,0.0360314137516000,0.0354777127180601,0.0348800861247068,0.0342401402952876,0.0335595908405206,0.0328402527906814,0.0320840382979445,0.0312929457853485,0.0304690572737960,0.0296145267351920,0.0287315773577529,0.0278224889836774,0.0268895954129827,0.0259352713105434,0.0249619294851316,0.0239720072782847,0.0229679642824752,0.0219522679840860,0.0209273923376460,0.0198958026092556,0.0188599548978800,0.0178222806003041,0.0167851866714834,0.0157510398777878,0.0147221681459778,0.0137008445561543,0.0126892896935510,0.0116896559083549,0.0107040304050486,0.00973442003583665,0.00878275519280410,0.00785087504202962,0.00694053268898701,0.00605338050499037,0.00519097671571493,0.00435477111795479,0.00354611294703713,0.00276623681619407,0.00201627233220745,0.00129722998673055,0.000610012523302845,-4.45990190761001e-05,-0.000665932518248199,-0.00125343810195681,-0.00180667440382880,-0.00232532123924779,-0.00280916458437056,-0.00325810894630045,-0.00367216124268514,-0.00405144251724865,-0.00439617097118067,-0.00470667327532655,-0.00498336645644592,-0.00522676927401569,-0.00543748259217205,-0.00561620125352288,-0.00576369311132471,-0.00588081093694837,-0.00596847069537563,-0.00602766363186324,-0.00605943348909241,-0.00606488903077331,-0.00604518058646921,-0.00600151266178136,-0.00593512027748656,-0.00584728143572537,-0.00573929354521750,-0.00561248609831709,-0.00546819653312283,-0.00530778383957331,-0.00513260399177078,-0.00494402407977145,-0.00474339761419135,-0.00453207957558094,-0.00431140119875253,-0.00408268629316821,-0.00384722541909614,-0.00360629354869915,-0.00336112413103945,-0.00311292722719260,-0.00286286423757499,-0.00261206665465724,-0.00236161082497061,-0.00211253770482508,-0.00186582796348525,-0.00162242231415800,-0.00138319713385577,-0.00114898541636875,-0.000920552748788416,-0.000698619447922474,-0.000483835885930399,-0.000276806503411686,-7.80647817119758e-05,0.000111901881794253,0.000292676962850102,0.000463888913714435,0.000625236158780627,0.000776460152074664,0.000917370439956340,0.00104781695802478,0.00116771464602476,0.00127701598641330,0.00137573466202004,0.00146391776020844,0.00154166991812049,0.00160912438248250,0.00166646749892866,0.00171390922182404,0.00175170787202405,0.00178013999257927,0.00179952559557787,0.00181019699654417,0.00181252541651140,0.00180688848306216,0.00179369727744292,0.00177336432508298,0.00174633010991377,0.00171303123561956,0.00167392729232437,0.00162946889656490,0.00158012488549913,0.00152635031827525,0.00146861375734487,0.00140736596787449,0.00134306707193251,0.00127615475255506,0.00120707336811951,0.00113624063858213,0.00106407799157221,0.000990977105679098,0.000917330818122963,0.000843499627284746,0.000769843078126542,0.000696686075526060,0.000624351422881045,0.000553125705451772,0.000483291607030441,0.000415095606253104,0.000348779157285519,0.000284546838935617,0.000222598455822985,0.000163096539342000,0.000106199517192029,5.20284902274254e-05,7.01209498865955e-07,-4.77009760520022e-05,-9.30988639122918e-05,-0.000135449614881011,-0.000174709931877667,-0.000210872091732796,-0.000243926709451713,-0.000273897729664828,-0.000300806194079904,-0.000324704261897088,-0.000345639704571766,-0.000363689630096665,-0.000378924280729169,-0.000391441476615873,-0.000401330962065220,-0.000408707088801112,-0.000413674200291730,-0.000416360434641095,-0.000416880555820502,-0.000415372286401209,-0.000411957318985585,-0.000406779085247442,-0.000399963355156309,-0.000391655231399366,-0.000381980925682637,-0.000371085298008465,-0.000359091759517786,-0.000346140969626917,-0.000332352411571494,-0.000317859953522892,-0.000302776201033587,-0.000287226800827898,-0.000271315249330752,-0.000255158264092647,-0.000238847992818863,-0.000222490447283802,-0.000206167045962058,-0.000189971677513269,-0.000173972892208912,-0.000158253707821362,-0.000142869437775721,-0.000127890706927779,-0.000113360569271834,-9.93367663080746e-05,-8.58514555859111e-05,-7.29489751881720e-05,-6.06501508549682e-05,-4.89891400411735e-05,-3.79751611176573e-05,-2.76312155424877e-05,-1.79581646955893e-05,-8.96900969145085e-06,-6.55137268709101e-07,6.97789377621773e-06,1.39477595623463e-05,2.02541172100938e-05,2.59234560218364e-05,3.09613806485637e-05,3.53977921139228e-05,3.92448899661170e-05,4.25373825294687e-05,4.52892632743473e-05,4.75385667982273e-05,4.93032309606633e-05,5.06213844697573e-05,5.15143625910949e-05,5.20185027363957e-05,5.21583781557696e-05,5.19714048029325e-05,5.14773398224135e-05,5.07171292012439e-05,4.97097791127208e-05,4.84922887066542e-05,4.70822383519769e-05,4.55174305776635e-05,4.38102652410623e-05,4.19985999292209e-05,4.00888019056904e-05,3.81189531156271e-05,3.60970578309992e-05,3.40467332801051e-05,3.19835801068571e-05,2.99282822271327e-05,2.78876020120787e-05,2.58805227080649e-05,2.39162208818158e-05,2.20055061843758e-05,2.01577025219395e-05,1.83751138282107e-05,1.66681637559877e-05,1.50545257512436e-05,1.35010055623710e-05,1.20580403789816e-05,1.06968763259065e-05,9.43097703994361e-06,8.24536112526484e-06,7.16117012783087e-06,6.15996450777538e-06,5.25290448510222e-06,4.42052824325994e-06,3.67717287779931e-06,8.78199583296425e-06];
 h=h';